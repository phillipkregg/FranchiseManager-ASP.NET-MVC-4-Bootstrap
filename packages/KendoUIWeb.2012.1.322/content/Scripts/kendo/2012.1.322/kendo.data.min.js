/*
* Kendo UI Web v2012.1.322 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
(function(a,b){function bs(b,c){var d=a(b)[0].tBodies[0],e=d?d.rows:[],f,g,h,i=c.length,j=[],k,l,m,n;for(f=0,g=e.length;f<g;f++){l={},n=!0,k=e[f].cells;for(h=0;h<i;h++)m=k[h],m.nodeName.toLowerCase()!=="th"&&(n=!1,l[c[h].field]=m.innerHTML);n||j.push(l)}return j}function br(b,c){var d=a(b)[0].children,e,f,g=[],h,i=c[0],j=c[1],k,l;for(e=0,f=d.length;e<f;e++)h={},l=d[e],h[i.field]=l.text,k=l.attributes.value,k&&k.specified?k=l.value:k=l.text,h[j.field]=k,g.push(h);return g}function bo(){this._store={}}function bl(a,b){var c=new _(a),b=b||{},d=b.aggregate,e=b.filter;e&&(c=c.filter(e));return c.aggregate(d)}function bk(a,c){var d=new _(a),c=c||{},e=c.group,f=bf(e||[]).concat(ba(c.sort||[])),g,h=c.filter,i=c.skip,j=c.take;h&&(d=d.filter(h),g=d.toArray().length),f&&(d=d.sort(f),e&&(a=d.toArray())),i!==b&&j!==b&&(d=d.range(i,j)),e&&(d=d.group(e,a));return{total:g,data:d.toArray()}}function bj(a){var b,c=a.length,d=Array(c);for(b=0;b<c;b++)d[b]=a[b].toJSON();return d}function bh(a,b,c,d,e){b=b||[];var f,g,h,i,j=b.length;for(f=0;f<j;f++){g=b[f],h=g.aggregate;var k=g.field;a[k]=a[k]||{},a[k][h]=bi[h.toLowerCase()](a[k][h],c,n.accessor(k),d,e)}}function bg(a,b){if(a&&a.getTime&&b&&b.getTime)return a.getTime()===b.getTime();return a===b}function bf(a,c){var d=typeof a===q?{field:a,dir:c}:a,e=h(d)?d:d!==b?[d]:[];return k(e,function(a){return{field:a.field,dir:a.dir||"asc",aggregates:a.aggregates}})}function be(a){return a=h(a)?a:[a]}function bd(a){if(a&&!g(a)){if(h(a)||!a.filters)a={logic:"and",filters:h(a)?a:[a]};bc(a);return a}}function bc(a){var b,c,d,e,f=a.filters;if(f)for(b=0,c=f.length;b<c;b++)d=f[b],e=d.operator,e&&typeof e===q&&(d.operator=bb[e.toLowerCase()]||e),bc(d)}function ba(a,c){if(a){var d=typeof a===q?{field:a,dir:c}:a,e=h(d)?d:d!==b?[d]:[];return i(e,function(a){return!!a.dir})}}function _(a){this.data=a||[]}function U(b,c){if(b===c)return!0;var d=a.type(b),e=a.type(c),f;if(d!==e)return!1;if(d==="date")return b.getTime()===c.getTime();if(d!=="object"&&d!=="array")return!1;for(f in b)if(!U(b[f],c[f]))return!1;return!0}var c=a.extend,d=a.proxy,e=a.isFunction,f=a.isPlainObject,g=a.isEmptyObject,h=a.isArray,i=a.grep,j=a.ajax,k,l=a.each,m=a.noop,n=window.kendo,o=n.Observable,p=n.Class,q="string",r="function",s="create",t="read",u="update",v="destroy",w="change",x="get",y="multiple",z="single",A="error",B="requestStart",C=[s,t,u,v],D=function(a){return a},E=n.getter,F=n.stringify,G=Math,H=[].push,I=[].join,J=[].pop,K=[].splice,L=[].shift,M=[].slice,N=[].unshift,O={}.toString,P=n.support.stableSort,Q=/^\/Date\((.*?)\)\/$/,R=/(?=['\\])/g,S=o.extend({init:function(a,b){var c=this;c.type=b||T,o.fn.init.call(c),c.length=a.length,c.wrapAll(a,c)},wrapAll:function(a,b){var c,d;b=b||[];for(c=0,d=a.length;c<d;c++)b[c]=this.wrap(a[c]);return b},wrap:function(a){var b=this;if(a!==null&&O.call(a)==="[object Object]"){var c=a instanceof b.type||a instanceof X;c||(a=a instanceof T?a.toJSON():a,a=new b.type(a)),a.bind(w,function(a){b.trigger(w,{field:a.field,items:[this],action:"itemchange"})})}return a},push:function(){var a=this.length,b=this.wrapAll(arguments),c;c=H.apply(this,b),this.trigger(w,{action:"add",index:a,items:b});return c},slice:M,join:I,pop:function(){var a=this.length,b=J.apply(this);a&&this.trigger(w,{action:"remove",index:a-1,items:[b]});return b},splice:function(a,b,c){var d=this.wrapAll(M.call(arguments,2)),e;e=K.apply(this,[a,b].concat(d)),e.length&&this.trigger(w,{action:"remove",index:a,items:e}),c&&this.trigger(w,{action:"add",index:a,items:d});return e},shift:function(){var a=this.length,b=L.apply(this);a&&this.trigger(w,{action:"remove",index:0,items:[b]});return b},unshift:function(){var a=this.wrapAll(arguments),b;b=N.apply(this,a),this.trigger(w,{action:"add",index:0,items:a});return b},indexOf:function(a){var b=this,c,d;for(c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1}}),T=o.extend({init:function(a){var b=this,c,d,e;o.fn.init.call(this);for(d in a)c=a[d],d.charAt(0)!="_"&&(e=O.call(c),c=b.wrap(c,d)),b[d]=c;b.uid=n.guid()},shouldSerialize:function(a){return this.hasOwnProperty(a)&&a!=="_events"&&typeof this[a]!==r&&a!=="uid"},toJSON:function(){var a={},b;for(b in this)this.shouldSerialize(b)&&(a[b]=this[b]);return a},get:function(a,b){var c=this,d,e;c.trigger(x,{field:a}),a==="this"?d=c:(e=n.getter(a,!0),d=e(c),b&&typeof d===r&&(d=d.call(c)));return d},_set:function(a,b){var c=this;if(a.indexOf(".")){var d=a.split("."),e="";while(d.length>1){e+=d.shift();var f=n.getter(e,!0)(c);if(f instanceof T){f.set(d.join("."),b);return}e+="."}}n.setter(a)(c,b)},set:function(a,b){var c=this,d=c[a],e;d!=b&&(c.trigger("set",{field:a,value:b})||(c._set(a,c.wrap(b,a)),c.trigger(w,{field:a})))},wrap:function(a,b){var c=this,d=O.call(a);a===null||d!=="[object Object]"||a instanceof bq?a!==null&&d==="[object Array]"&&(a=new S(a),function(b){a.bind(w,function(a){c.trigger(w,{field:b,index:a.index,items:a.items,action:a.action})})}(b)):(a instanceof T||(a=new T(a)),function(b){a.bind(x,function(a){a.field=b+"."+a.field,c.trigger(x,a)}),a.bind(w,function(a){a.field=b+"."+a.field,c.trigger(w,a)})}(b));return a}}),V={number:function(a){return n.parseFloat(a)},date:function(a){if(typeof a===q){var b=Q.exec(a);if(b)return new Date(parseInt(b[1]))}return n.parseDate(a)},"boolean":function(a){if(typeof a===q)return a.toLowerCase()==="true";return!!a},string:function(a){return a+""},"default":function(a){return a}},W={string:"",number:0,date:new Date,"boolean":!1,"default":""},X=T.extend({init:function(c){var d=this;if(!c||a.isEmptyObject(c))c=a.extend({},d.defaults,c);T.fn.init.call(d,c),d.dirty=!1,d.idField&&(d.id=d.get(d.idField),d.id===b&&(d.id=d._defaultId))},shouldSerialize:function(a){return T.fn.shouldSerialize.call(this,a)&&a!=="uid"&&(this.idField==="id"||a!=="id")&&a!=="dirty"&&a!=="_accessors"},_parse:function(a,b){var c=this,d;a=(c.fields||{})[a],a&&(d=a.parse,!d&&a.type&&(d=V[a.type.toLowerCase()]));return d?d(b):b},editable:function(a){a=(this.fields||{})[a];return a?a.editable!==!1:!0},set:function(a,b,c){var d=this;d.editable(a)&&(b=d._parse(a,b),U(b,d.get(a))||(T.fn.set.call(d,a,b,c),d.dirty=!0))},accept:function(a){var b=this;c(b,a),b.idField&&(b.id=b.get(b.idField)),b.dirty=!1},isNew:function(){return this.id===this._defaultId}});X.define=function(a){var d,e=c({},{defaults:{}},a),f=e.id;f&&(e.idField=f),e.id&&delete e.id,f&&(e.defaults[f]=e._defaultId="");for(var g in e.fields){var h=e.fields[g],i=h.type||"default",j=null;g=h.field||g,h.nullable||(j=e.defaults[g]=h.defaultValue!==b?h.defaultValue:W[i.toLowerCase()]),a.id===g&&(e._defaultId=j),e.defaults[g]=j,h.parse=h.parse||V[i]}d=X.extend(e),e.fields&&(d.fields=e.fields,d.idField=e.idField);return d};var Y={selector:function(a){return e(a)?a:E(a)},asc:function(a){var b=this.selector(a);return function(a,c){a=b(a),c=b(c);return a>c?1:a<c?-1:0}},desc:function(a){var b=this.selector(a);return function(a,c){a=b(a),c=b(c);return a<c?1:a>c?-1:0}},create:function(a){return Y[a.dir.toLowerCase()](a.field)},combine:function(a){return function(b,c){var d=a[0](b,c),e,f;for(e=1,f=a.length;e<f;e++)d=d||a[e](b,c);return d}}},Z={selector:function(a){return e(a)?a:E(a)},asc:function(a){var b=this.selector(a);return function(a,c){var d=b(a),e=b(c);if(d===e)return a.__position-c.__position;return d>e?1:d<e?-1:0}},desc:function(a){var b=this.selector(a);return function(a,c){var d=b(a),e=b(c);if(d===e)return a.__position-c.__position;return d<e?1:d>e?-1:0}},create:function(a){return Z[a.dir.toLowerCase()](a.field)},combine:function(a){return function(b,c){var d=a[0](b,c),e,f;for(e=1,f=a.length;e<f;e++)d=d||a[e](b,c);return d}}};k=function(a,b){var c,d=a.length,e=Array(d);for(c=0;c<d;c++)e[c]=b(a[c],c,a);return e};var $=function(){function c(c,d,e,f){var g;e!=b&&(typeof e===q&&(e=a(e),g=Q.exec(e),g?e=new Date(+g[1]):f?(e="'"+e.toLowerCase()+"'",d=d+".toLowerCase()"):e="'"+e+"'"),e.getTime&&(d="("+d+"?"+d+".getTime():"+d+")",e=e.getTime()));return d+" "+c+" "+e}function a(a){return a.replace(R,"\\")}return{eq:function(a,b,d){return c("==",a,b,d)},neq:function(a,b,d){return c("!=",a,b,d)},gt:function(a,b,d){return c(">",a,b,d)},gte:function(a,b,d){return c(">=",a,b,d)},lt:function(a,b,d){return c("<",a,b,d)},lte:function(a,b,d){return c("<=",a,b,d)},startswith:function(b,c,d){d&&(b=b+".toLowerCase()",c&&(c=c.toLowerCase())),c&&(c=a(c));return b+".lastIndexOf('"+c+"', 0) == 0"},endswith:function(b,c,d){d&&(b=b+".toLowerCase()",c&&(c=c.toLowerCase())),c&&(c=a(c));return b+".lastIndexOf('"+c+"') == "+b+".length - "+(c||"").length},contains:function(b,c,d){d&&(b=b+".toLowerCase()",c&&(c=c.toLowerCase())),c&&(c=a(c));return b+".indexOf('"+c+"') >= 0"}}}();_.normalizeFilter=bd,_.filterExpr=function(a){var c=[],d={and:" && ",or:" || "},e,f,g,h,i=[],j=[],k,l,m=a.filters;for(e=0,f=m.length;e<f;e++)g=m[e],k=g.field,l=g.operator,g.filters?(h=_.filterExpr(g),g=h.expression.replace(/__o\[(\d+)\]/g,function(a,b){b=+b;return"__o["+(j.length+b)+"]"}).replace(/__f\[(\d+)\]/g,function(a,b){b=+b;return"__f["+(i.length+b)+"]"}),j.push.apply(j,h.operators),i.push.apply(i,h.fields)):(typeof k===r?(h="__f["+i.length+"](d)",i.push(k)):h=n.expr(k),typeof l===r?(g="__o["+j.length+"]("+h+", "+g.value+")",j.push(l)):g=$[(l||"eq").toLowerCase()](h,g.value,g.ignoreCase!==b?g.ignoreCase:!0)),c.push(g);return{expression:"("+c.join(d[a.logic])+")",fields:i,operators:j}};var bb={"==":"eq",equals:"eq",isequalto:"eq",equalto:"eq",equal:"eq","!=":"neq",ne:"neq",notequals:"neq",isnotequalto:"neq",notequalto:"neq",notequal:"neq","<":"lt",islessthan:"lt",lessthan:"lt",less:"lt","<=":"lte",le:"lte",islessthanorequalto:"lte",lessthanequal:"lte",">":"gt",isgreaterthan:"gt",greaterthan:"gt",greater:"gt",">=":"gte",isgreaterthanorequalto:"gte",greaterthanequal:"gte",ge:"gte"};_.prototype={toArray:function(){return this.data},range:function(a,b){return new _(this.data.slice(a,a+b))},skip:function(a){return new _(this.data.slice(a))},take:function(a){return new _(this.data.slice(0,a))},select:function(a){return new _(k(this.data,a))},orderBy:function(a){var b=this.data.slice(0),c=e(a)||!a?Y.asc(a):a.compare;return new _(b.sort(c))},orderByDescending:function(a){return new _(this.data.slice(0).sort(Y.desc(a)))},sort:function(a,b,c){var d,e,f=ba(a,b),g=[];c=c||Y;if(f.length){for(d=0,e=f.length;d<e;d++)g.push(c.create(f[d]));return this.orderBy({compare:c.combine(g)})}return this},filter:function(a){var b,c,d,e,f,g=this.data,h,i,j=[],k;a=bd(a);if(!a||a.filters.length===0)return this;e=_.filterExpr(a),h=e.fields,i=e.operators,f=k=new Function("d, __f, __o","return "+e.expression);if(h.length||i.length)k=function(a){return f(a,h,i)};for(b=0,d=g.length;b<d;b++)c=g[b],k(c)&&j.push(c);return new _(j)},group:function(a,b){a=bf(a||[]),b=b||this.data;var c=this,d=new _(c.data),e;a.length>0&&(e=a[0],d=d.groupBy(e).select(function(c){var d=(new _(b)).filter([{field:c.field,operator:"eq",value:c.value}]);return{field:c.field,value:c.value,items:a.length>1?(new _(c.items)).group(a.slice(1),d.toArray()).toArray():c.items,hasSubgroups:a.length>1,aggregates:d.aggregate(e.aggregates)}}));return d},groupBy:function(a){if(g(a)||!this.data.length)return new _([]);var b=a.field,c=this._sortForGrouping(b,a.dir||"asc"),d=n.accessor(b),e,f=d.get(c[0],b),h={field:b,value:f,items:[]},i,j,k,l=[h];for(j=0,k=c.length;j<k;j++)e=c[j],i=d.get(e,b),bg(f,i)||(f=i,h={field:b,value:f,items:[]},l.push(h)),h.items.push(e);return new _(l)},_sortForGrouping:function(a,b){var c,d,e=this.data;if(!P){for(c=0,d=e.length;c<d;c++)e[c].__position=c;e=(new _(e)).sort(a,b,Z).toArray();for(c=0,d=e.length;c<d;c++)delete e[c].__position;return e}return this.sort(a,b).toArray()},aggregate:function(a){var b,c,d={};if(a&&a.length)for(b=0,c=this.data.length;b<c;b++)bh(d,a,this.data[b],b,c);return d}};var bi={sum:function(a,b,c){return a=(a||0)+c.get(b)},count:function(a,b,c){return(a||0)+1},average:function(a,b,c,d,e){a=(a||0)+c.get(b),d==e-1&&(a=a/e);return a},max:function(a,b,c){var a=a||0,d=c.get(b);a<d&&(a=d);return a},min:function(a,b,c){var d=c.get(b),a=a||d;a>d&&(a=d);return a}},bm=p.extend({init:function(a){this.data=a.data},read:function(a){a.success(this.data)},update:function(a){a.success(a.data)},create:function(a){a.success(a.data)},destroy:m}),bn=p.extend({init:function(a){var b=this,d;a=b.options=c({},b.options,a),l(C,function(b,c){typeof a[c]===q&&(a[c]={url:a[c]})}),b.cache=a.cache?bo.create(a.cache):{find:m,add:m},d=a.parameterMap,b.parameterMap=e(d)?d:function(a){var b={};l(a,function(a,c){a in d&&(a=d[a],f(a)&&(c=a.value(c),a=a.key)),b[a]=c});return b}},options:{parameterMap:D},create:function(a){return j(this.setup(a,s))},read:function(c){var d=this,e,f,g,h=d.cache;c=d.setup(c,t),e=c.success||m,f=c.error||m,g=h.find(c.data),g!==b?e(g):(c.success=function(a){h.add(c.data,a),e(a)},a.ajax(c))},update:function(a){return j(this.setup(a,u))},destroy:function(a){return j(this.setup(a,v))},setup:function(a,b){a=a||{};var d=this,f,g=d.options[b],h=e(g.data)?g.data():g.data;a=c(!0,{},g,a),f=c(h,a.data),a.data=d.parameterMap(f,b),e(a.url)&&(a.url=a.url(f));return a}});bo.create=function(a){var b={inmemory:function(){return new bo}};if(f(a)&&e(a.find))return a;if(a===!0)return new bo;return b[a]()},bo.prototype={add:function(a,c){a!==b&&(this._store[F(a)]=c)},find:function(a){return this._store[F(a)]},clear:function(){this._store={}},remove:function(a){delete this._store[F(a)]}};var bp=p.extend({init:function(a){var b=this,c,d,e;a=a||{};for(c in a)d=a[c],b[c]=typeof d===q?E(d):d;if(f(b.model)){b.model=e=n.data.Model.define(b.model);var h=b.data,i={};e.fields&&l(e.fields,function(a,b){f(b)&&b.field?i[b.field]=E(b.field):i[a]=E(a)}),b.data=function(a){var c,d,e,f,j=new b.model;a=h(a);if(!g(i))for(e=0,f=a.length;e<f;e++){c=a[e];for(d in i)c[d]=j._parse(d,i[d](c))}return a}}},parse:D,data:D,total:function(a){return a.length},groups:D,status:function(a){return a.status},aggregates:function(){return{}}}),bq=o.extend({init:function(a){var d=this,f,g,h;a=d.options=c({},d.options,a),c(d,{_map:{},_prefetch:{},_data:[],_ranges:[],_view:[],_pristine:[],_destroyed:[],_pageSize:a.pageSize,_page:a.page||(a.pageSize?1:b),_sort:ba(a.sort),_filter:bd(a.filter),_group:bf(a.group),_aggregate:a.aggregate}),o.fn.init.call(d),h=a.transport,h?(h.read=typeof h.read===q?{url:h.read}:h.read,a.type&&(h=c(!0,{},n.data.transports[a.type],h),a.schema=c(!0,{},n.data.schemas[a.type],a.schema)),d.transport=e(h.read)?h:new bn(h)):d.transport=new bm({data:a.data}),d.reader=new n.data.readers[a.schema.type||"json"](a.schema),g=d.reader.model||{},d._data=d._observe(d._data),f=g.id,f&&(d.id=function(a){return f(a)}),d.bind([A,w,B],a)},options:{data:[],schema:{},serverSorting:!1,serverPaging:!1,serverFiltering:!1,serverGrouping:!1,serverAggregates:!1,sendAllFields:!0,batch:!1},get:function(a){var b,c,d=this._data;for(b=0,c=d.length;b<c;b++)if(d[b].id==a)return d[b]},getByUid:function(a){var b,c,d=this._data;for(b=0,c=d.length;b<c;b++)if(d[b].uid==a)return d[b]},sync:function(){var b=this,c,d,e=[],f=[],g=b._destroyed,h=b._data;if(!!b.reader.model){for(c=0,d=h.length;c<d;c++)h[c].isNew()?e.push(h[c]):h[c].dirty&&f.push(h[c]);var i=b._send("create",e);i.push.apply(i,b._send("update",f)),i.push.apply(i,b._send("destroy",g)),a.when.apply(null,i).then(function(){var a,c;for(a=0,c=arguments.length;a<c;a++)b._accept(arguments[a]);b._change()})}},_accept:function(b){var d=this,e=b.models,f=b.response,g=0,h=d.reader.data(d._pristine),i=b.type,j;f?f=d.reader.data(d.reader.parse(f)):f=a.map(e,function(a){return a.toJSON()}),a.isArray(f)||(f=[f]),i==="destroy"&&(d._destroyed=[]);for(g=0,j=e.length;g<j;g++)i!=="destroy"?(e[g].accept(f[g]),i==="create"?h.push(e[g]):i==="update"&&c(h[d._pristineIndex(e[g])],f[g])):h.splice(d._pristineIndex(e[g]),1)},_pristineIndex:function(a){var b=this,c,d,e=b.reader.data(b._pristine);for(c=0,d=e.length;c<d;c++)if(e[c][a.idField]===a.id)return c;return-1},_promise:function(b,d,e){var f=this,g=f.transport;return a.Deferred(function(a){g[e].call(g,c({success:function(b){a.resolve({response:b,models:d,type:e})},error:function(b){a.reject(b),f.trigger(A,b)}},b))}).promise()},_send:function(a,b){var c=this,d,e,f=[],g=c.transport;if(c.options.batch)b.length&&f.push(c._promise({data:{models:bj(b)}},b,a));else for(d=0,e=b.length;d<e;d++)f.push(c._promise({data:b[d].toJSON()},[b[d]],a));return f},add:function(a){return this.insert(this._data.length,a)},insert:function(a,b){b||(b=a,a=0),b instanceof X||(this.reader.model?b=new this.reader.model(b):b=new T(b)),this._data.splice(a,0,b);return b},cancelChanges:function(a){var b=this,d,e=b.reader.data(b._pristine),f;a instanceof n.data.Model?(f=b.indexOf(a),d=b._pristineIndex(a),f!=-1&&(d!=-1&&!a.isNew()?c(!0,b._data[f],e[d]):b._data.splice(f,1))):(b._data=b._observe(e),b._change())},read:function(a){var b=this,c=b._params(a);b._queueRequest(c,function(){b.trigger(B),b._ranges=[],b.transport.read({data:c,success:d(b.success,b),error:d(b.error,b)})})},indexOf:function(a){var b,c,d=this._data;if(a)for(b=0,c=d.length;b<c;b++)if(d[b].uid==a.uid)return b;return-1},_params:function(a){var b=this,d=c({take:b.take(),skip:b.skip(),page:b.page(),pageSize:b.pageSize(),sort:b._sort,filter:b._filter,group:b._group,aggregate:b._aggregate},a);b.options.serverPaging||(delete d.take,delete d.skip,delete d.page,delete d.pageSize);return d},_queueRequest:function(a,c){var e=this;e._requestInProgress?e._pending={callback:d(c,e),options:a}:(e._requestInProgress=!0,e._pending=b,c())},_dequeueRequest:function(){var a=this;a._requestInProgress=!1,a._pending&&a._queueRequest(a._pending.options,a._pending.callback)},remove:function(a){var b,c,d=this._data;for(b=0,c=d.length;b<c;b++)if(d[b].uid==a.uid){a=d[b],d.splice(b,1);return a}},error:function(a,b,c){this.trigger(A,{xhr:a,status:b,errorThrown:c})},success:function(b){var c=this,d={},e,g=c.options.serverGrouping===!0&&c._group&&c._group.length>0;b=c.reader.parse(b),c._pristine=f(b)?a.extend(!0,{},b):b.slice(0),c._total=c.reader.total(b),c._aggregate&&c.options.serverAggregates&&(c._aggregateResult=c.reader.aggregates(b)),g?b=c.reader.groups(b):b=c.reader.data(b),c._data=c._observe(b);var h=c._skip||0,i=h+c._data.length;c._ranges.push({start:h,end:i,data:c._data}),c._ranges.sort(function(a,b){return a.start-b.start}),c._dequeueRequest(),c._process(c._data)},_observe:function(a){var b=this,c=b.reader.model,e=!1;c&&a.length&&(e=!(a[0]instanceof c)),a instanceof S?e&&(a.type=b.reader.model,a.wrapAll(a,a)):a=new S(a,b.reader.model);return a.bind(w,d(b._change,b))},_change:function(a){var b=this,c,d,e=a?a.action:"";if(e==="remove")for(c=0,d=a.items.length;c<d;c++)(!a.items[c].isNew||!a.items[c].isNew())&&b._destroyed.push(a.items[c]);if(!b.options.autoSync||e!=="add"&&e!=="remove"&&e!=="itemchange"){var f=b._total||b.reader.total(b._pristine);e==="add"?f++:e==="remove"?f--:e!=="itemchange"&&!b.options.serverPaging&&(f=b.reader.total(b._pristine)),b._total=f,b._process(b._data,a)}else b.sync()},_process:function(a,c){var d=this,e={},f,g=d.options.serverGrouping===!0&&d._group&&d._group.length>0;d.options.serverPaging!==!0&&(e.skip=d._skip,e.take=d._take||d._pageSize,e.skip===b&&d._page!==b&&d._pageSize!==b&&(e.skip=(d._page-1)*d._pageSize)),d.options.serverSorting!==!0&&(e.sort=d._sort),d.options.serverFiltering!==!0&&(e.filter=d._filter),d.options.serverGrouping!==!0&&(e.group=d._group),d.options.serverAggregates!==!0&&(e.aggregate=d._aggregate,d._aggregateResult=bl(a,e)),f=bk(a,e),d._view=f.data,f.total!==b&&!d.options.serverFiltering&&(d._total=f.total),d.trigger(w,c)},at:function(a){return this._data[a]},data:function(a){var c=this;if(a!==b)c._data=this._observe(a),c._total=c._data.length,c._process(c._data);else return c._data},view:function(){return this._view},query:function(a){var c=this,d,e=c.options.serverSorting||c.options.serverPaging||c.options.serverFiltering||c.options.serverGrouping||c.options.serverAggregates;a!==b&&(c._pageSize=a.pageSize,c._page=a.page,c._sort=a.sort,c._filter=a.filter,c._group=a.group,c._aggregate=a.aggregate,c._skip=a.skip,c._take=a.take,c._skip===b&&(c._skip=c.skip(),a.skip=c.skip()),c._take===b&&c._pageSize!==b&&(c._take=c._pageSize,a.take=c._take),a.sort&&(c._sort=a.sort=ba(a.sort)),a.filter&&(c._filter=a.filter=bd(a.filter)),a.group&&(c._group=a.group=bf(a.group)),a.aggregate&&(c._aggregate=a.aggregate=be(a.aggregate))),e||c._data===b||c._data.length==0?c.read(a):(c.trigger(B),d=bk(c._data,a),c.options.serverFiltering||(d.total!==b?c._total=d.total:c._total=c._data.length),c._view=d.data,c._aggregateResult=bl(c._data,a),c.trigger(w))},fetch:function(a){var b=this;a&&e(a)&&b.one(w,a),b._query()},_query:function(a){var b=this;b.query(c({},{page:b.page(),pageSize:b.pageSize(),sort:b.sort(),filter:b.filter(),group:b.group(),aggregate:b.aggregate()},a))},page:function(a){var c=this,d;if(a!==b)a=G.max(G.min(G.max(a,1),c.totalPages()),1),c._query({page:a});else{d=c.skip();return d!==b?G.round((d||0)/(c.take()||1))+1:b}},pageSize:function(a){var c=this;if(a!==b)c._query({pageSize:a});else return c.take()},sort:function(a){var c=this;if(a!==b)c._query({sort:a});else return c._sort},filter:function(a){var c=this;if(a===b)return c._filter;c._query({filter:a,page:1})},group:function(a){var c=this;if(a!==b)c._query({group:a});else return c._group},total:function(){return this._total||0},aggregate:function(a){var c=this;if(a!==b)c._query({aggregate:a});else return c._aggregate},aggregates:function(){return this._aggregateResult},totalPages:function(){var a=this,b=a.pageSize()||a.total();return G.ceil((a.total()||0)/b)},inRange:function(a,b){var c=this,d=G.min(a+b,c.total());if(!c.options.serverPaging&&c.data.length>0)return!0;return c._findRange(a,d).length>0},range:function(a,c){a=G.min(a||0,this.total());var d=this,e=G.max(G.floor(a/c),0)*c,f=G.min(e+c,d.total()),g;g=d._findRange(a,G.min(a+c,d.total()));if(g.length){d._skip=a>d.skip()?G.min(f,(d.totalPages()-1)*d.take()):e,d._take=c;var h=d.options.serverPaging,i=d.options.serverSorting;try{d.options.serverPaging=!0,d.options.serverSorting=!0,d._process(g)}finally{d.options.serverPaging=h,d.options.serverSorting=i}}else c!==b&&(d._rangeExists(e,f)?e<a&&d.prefetch(f,c,function(){d.range(a,c)}):d.prefetch(e,c,function(){a>e&&f<d.total()&&!d._rangeExists(f,G.min(f+c,d.total()))?d.prefetch(f,c,function(){d.range(a,c)}):d.range(a,c)}))},_findRange:function(a,c){var d=this,e=d._ranges,f,g=[],h,i,j,k,l,m,n,o=d.options,p=o.serverSorting||o.serverPaging||o.serverFiltering||o.serverGrouping||o.serverAggregates,q;for(h=0,q=e.length;h<q;h++){f=e[h];if(a>=f.start&&a<=f.end){var r=0;for(i=h;i<q;i++){f=e[i];if(f.data.length&&a+r>=f.start){l=f.data,m=f.end,p||(n=bk(f.data,{sort:d.sort(),filter:d.filter()}),l=n.data,n.total!==b&&(m=n.total)),j=0,a+r>f.start&&(j=a+r-f.start),k=l.length,m>c&&(k=k-(m-c)),r+=k-j,g=g.concat(l.slice(j,k));if(c<=f.end&&r==c-a)return g}}break}}return[]},skip:function(){var a=this;if(a._skip===b)return a._page!==b?(a._page-1)*(a.take()||1):b;return a._skip},take:function(){var a=this;return a._take||a._pageSize},prefetch:function(a,b,c){var d=this,e=G.min(a+b,d.total()),f={start:a,end:e,data:[]},g={take:b,skip:a,page:a/b+1,pageSize:b,sort:d._sort,filter:d._filter,group:d._group,aggregate:d._aggregate};d._rangeExists(a,e)?c&&c():(clearTimeout(d._timeout),d._timeout=setTimeout(function(){d._queueRequest(g,function(){d.transport.read({data:g,success:function(b){d._dequeueRequest();var e=!1;for(var g=0,h=d._ranges.length;g<h;g++)if(d._ranges[g].start===a){e=!0,f=d._ranges[g];break}e||d._ranges.push(f),b=d.reader.parse(b),f.data=d._observe(d.reader.data(b)),f.end=f.start+f.data.length,d._ranges.sort(function(a,b){return a.start-b.start}),d._total=d.reader.total(b),c&&c()}})})},100))},_rangeExists:function(a,b){var c=this,d=c._ranges,e,f;for(e=0,f=d.length;e<f;e++)if(d[e].start<=a&&d[e].end>=b)return!0;return!1}});bq.create=function(a){a=a&&a.push?{data:a}:a;var b=a||{},d=b.data,e=b.fields,f=b.table,h=b.select,i,j,k={},l;!d&&e&&!b.transport&&(f?d=bs(f,e):h&&(d=br(h,e)));if(n.data.Model&&e&&(!b.schema||!b.schema.model)){for(i=0,j=e.length;i<j;i++)l=e[i],l.type&&(k[l.field]=l);g(k)||(b.schema=c(!0,b.schema,{model:{fields:k}}))}b.data=d;return b instanceof bq?b:new bq(b)},c(!0,n.data,{readers:{json:bp},Query:_,DataSource:bq,ObservableObject:T,ObservableArray:S,LocalTransport:bm,RemoteTransport:bn,Cache:bo,DataReader:bp,Model:X})})(jQuery)