/*
* Kendo UI Web v2012.1.322 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
(function(a,b){function z(b,c){!c||b.filters&&(b.filters=a.grep(b.filters,function(a){z(a,c);return a.filters?a.filters.length:a.field!=c}))}var c=window.kendo,d=c.ui,e=d.List,f=d.Select,g=c.support,h=g.placeholder,i=c.keys,j=g.touch?"touchend":"click",k="disabled",l="change",m="k-state-default",n="k-state-disabled",o="k-state-focused",p="mousedown",q="select",r="k-state-selected",s="filter",t="accept",u="k-state-hover",v="mouseenter mouseleave",w=null,x=a.proxy,y=f.extend({init:function(b,d){var e=this,g;d=a.isArray(d)?{dataSource:d}:d,f.fn.init.call(e,b,d),d=e.options,b=e.element.focus(function(){e.input.focus()}),d.placeholder=d.placeholder||b.attr("placeholder"),e._reset(),e._wrapper(),e._input(),e._popup(),e._accessors(),e._dataSource(),e._enable(),g=e._inputWrapper,e.input.bind({keydown:x(e._keydown,e),focus:function(){g.addClass(o),e._placeholder(!1)},blur:function(){g.removeClass(o),clearTimeout(e._typing),e.text(e.text()),e._placeholder(),e._blur()}}),e._oldIndex=e.selectedIndex=-1,e._old=e.value(),d.autoBind?e._selectItem():b.is(q)&&e.input.val(b.children(":selected").text()),e._placeholder(),c.notify(e)},options:{name:"ComboBox",enable:!0,index:-1,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,animation:{}},events:["open","close",l,"select","dataBinding","dataBound"],setOptions:function(a){f.fn.setOptions.call(this,a),this._template(),this._accessors()},current:function(a){var c=this,d=c._current;if(a===b)return d;d&&d.removeClass(r),f.fn.current.call(c,a)},enable:function(a){var b=this,c=b.input.add(b.element),d=b._inputWrapper.unbind(v),e=b._arrow.parent().unbind(j+" "+p);a===!1?(d.removeClass(m).addClass(n),c.attr(k,k)):(d.removeClass(n).addClass(m).bind(v,b._toggleHover),c.removeAttr(k),e.bind(j,function(){b.toggle()}).bind(p,function(a){a.preventDefault()}))},open:function(){var a=this,b=a.dataSource.options.serverFiltering;a.popup.visible()||(!a.ul[0].firstChild||a._state===t&&!b?(a._open=!0,a._state="",a._selectItem()):(a.popup.open(),a._scroll(a._current)))},refresh:function(){var b=this,d=b.ul[0],e=b.popup,f=b.options,g=f.suggest,h=f.height,i=b._data(),j=i.length;b.trigger("dataBinding"),d.innerHTML=c.render(b.template,i),b._height(j),b.element.is(q)&&b._options(i),j&&((g||f.highlightFirst)&&b.current(a(d.firstChild)),g&&b.input.val()&&b.suggest(b._current)),b._open&&(b._open=!1,b.toggle(!!j)),b._touchScroller&&b._touchScroller.reset(),b._makeUnselectable(),b._hideBusy(),b.trigger("dataBound")},select:function(a){var c=this;if(a===b)return c.selectedIndex;c._select(a),c._old=c._accessor(),c._oldIndex=c.selectedIndex},search:function(a){a=typeof a=="string"?a:this.text();var b=this,c=a.length,d=b.options,e=d.filter,f=d.dataTextField,g;clearTimeout(b._typing),c>=d.minLength&&(e==="none"?b._filter(a):(b._open=!0,b._state=s,g=b.dataSource.filter()||{},z(g,f),filters=g.filters||[],filters.push({field:f,operator:e,value:a}),b.dataSource.filter(filters)))},suggest:function(a){var c=this,d=c.input[0],f=c.text(),g=e.caret(d),h=c._last,j;if(h==i.BACKSPACE||h==i.DELETE)c._last=b;else{a=a||"",typeof a!="string"&&(j=a.index(),j>-1?a=c._text(c.dataSource.view()[j]):a=""),g<=0&&(g=f.toLowerCase().indexOf(a.toLowerCase())+1),a?(j=a.toLowerCase().indexOf(f.toLowerCase()),j>-1&&(f+=a.substring(j+f.length))):f=f.substring(0,g);if(f.length!==g||!a)f.toLowerCase()===a.toLowerCase()&&(f=a),c.text(f),e.selectText(d,g,f.length)}},text:function(a){var c=this,d=c._text,e=c.input[0],f;if(a===b)return e.value;f=c.dataItem();if(!f||d(f)!==a)c._select(function(b){return d(b)===a}),c.selectedIndex<0&&c._custom(a),e.value=a},toggle:function(a){var b=this;b._toggle(a)},value:function(a){var c=this,d=c.element,e;if(a===b)return c._accessor();if(!a||!c._valueOnFetch(a))e=c._index(a),e>-1?c.select(e):(c.current(w),c._custom(a),c.text(a)),c._old=c._accessor(),c._oldIndex=c.selectedIndex},_accept:function(a){var b=this;a&&b.popup.visible()?(b._state===s&&(b._state=t),b._focus(a)):(b.text(b.text()),b._change())},_custom:function(b){var c=this,d=c.element,e=c._option;d.is(q)?(e||(e=c._option=a("<option/>"),d.append(e)),e.text(b),e[0].selected=!0):d.val(b)},_filter:function(a){a=a.toLowerCase();var c=this,d=c.options,e=c.dataSource,f=function(d){var e=c._text(d);if(e!==b){e=e+"";if(e!==""&&a==="")return!1;return e.toLowerCase().indexOf(a)===0}};c.ul[0].firstChild?(c._highlight(f)!==-1&&(d.suggest&&c._current&&c.suggest(c._current),c.open()),c._hideBusy()):e.one(l,function(){c.search(a)}).fetch()},_highlight:function(c){var d=this,f;if(c==b)return-1;c=d._get(c),f=e.inArray(c[0],d.ul[0]),f==-1&&(d.options.highlightFirst&&!d.text()?c=a(d.ul[0].firstChild):c=w),d.current(c);return f},_input:function(){var b=this,c=b.element[0],d=b.wrapper,e=".k-input",f;f=d.find(e),f[0]||(d.append('<span unselectable="on" class="k-dropdown-wrap k-state-default"><input class="k-input" type="text" autocomplete="off"/><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-arrow-down">select</span></span></span>').append(b.element),f=d.find(e)),f[0].style.cssText=c.style.cssText,f.addClass(c.className).val(c.value).css({width:"100%",height:c.style.height}).show(),h&&f.attr("placeholder",b.options.placeholder),b._focused=b.input=f,b._arrow=d.find(".k-icon"),b._inputWrapper=a(d[0].firstChild)},_keydown:function(a){var b=this,c=a.keyCode,d=b.input;b._last=c,clearTimeout(b._typing),c==i.TAB?(b.text(d.val()),b._state===s&&b.selectedIndex>-1&&(b._state=t)):b._move(a)||b._search()},_placeholder:function(a){if(!h){var c=this,d=c.input,e=c.options.placeholder,f;e&&(f=c.value(),a===b&&(a=!f),a||(f?e=d.val():e=""),d.toggleClass("k-readonly",a).val(e))}},_search:function(){var a=this;a._typing=setTimeout(function(){var b=a.text();a._prev!==b&&(a._prev=b,a.search(b))},a.options.delay)},_select:function(a){var c=this,d,e,f=c._highlight(a),g=c._data();c.selectedIndex=f,f!==-1&&(c._current.addClass(r),g=g[f],d=c._text(g),e=c._value(g),c._prev=c.input[0].value=d,c._accessor(e!=b?e:d,f),c._placeholder())},_selectItem:function(){var a=this,b=a.dataSource,c=b.filter()||{};z(c,a.options.dataTextField),a.dataSource.one(l,function(){var b=a.value();b?a.value(b):a.select(a.options.index)}).filter(c)},_wrapper:function(){var a=this,b=a.element,c;c=b.parent(),c.is("span.k-widget")||(c=b.hide().wrap("<span />").parent()),c[0].style.cssText=b[0].style.cssText,a.wrapper=c.addClass("k-widget k-combobox k-header").show()}});d.plugin(y)})(jQuery)